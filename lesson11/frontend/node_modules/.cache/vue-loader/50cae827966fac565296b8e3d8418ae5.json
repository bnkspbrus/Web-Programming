{"remainingRequest":"/home/nikita/WEB/lesson11/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/nikita/WEB/lesson11/frontend/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/nikita/WEB/lesson11/frontend/src/App.vue","mtime":1640358482747},{"path":"/home/nikita/WEB/lesson11/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/nikita/WEB/lesson11/frontend/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/nikita/WEB/lesson11/frontend/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/nikita/WEB/lesson11/frontend/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBIZWFkZXIgZnJvbSAiLi9jb21wb25lbnRzL0hlYWRlciI7CmltcG9ydCBNaWRkbGUgZnJvbSAiLi9jb21wb25lbnRzL01pZGRsZSI7CmltcG9ydCBGb290ZXIgZnJvbSAiLi9jb21wb25lbnRzL0Zvb3RlciI7CmltcG9ydCBheGlvcyBmcm9tICJheGlvcyIKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQXBwJywKICBjb21wb25lbnRzOiB7CiAgICBGb290ZXIsCiAgICBNaWRkbGUsCiAgICBIZWFkZXIKICB9LAogIGRhdGE6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHsKICAgICAgdXNlcjogbnVsbCwKICAgICAgcG9zdHM6IFtdCiAgICB9CiAgfSwKICBiZWZvcmVNb3VudCgpIHsKICAgIGlmIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgiand0IikgJiYgIXRoaXMudXNlcikgewogICAgICB0aGlzLiRyb290LiRlbWl0KCJvbkp3dCIsIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJqd3QiKSk7CiAgICB9CgogICAgYXhpb3MuZ2V0KCIvYXBpLzEvcG9zdHMiKS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgdGhpcy5wb3N0cyA9IHJlc3BvbnNlLmRhdGE7CiAgICB9KTsKICB9LAogIGJlZm9yZUNyZWF0ZSgpIHsKICAgIHRoaXMuJHJvb3QuJG9uKCJvbkVudGVyIiwgKGxvZ2luLCBwYXNzd29yZCkgPT4gewogICAgICBpZiAocGFzc3dvcmQgPT09ICIiKSB7CiAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgib25FbnRlclZhbGlkYXRpb25FcnJvciIsICJQYXNzd29yZCBpcyByZXF1aXJlZCIpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgYXhpb3MucG9zdCgiL2FwaS8xL2p3dCIsIHsKICAgICAgICBsb2dpbiwgcGFzc3dvcmQKICAgICAgfSkudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImp3dCIsIHJlc3BvbnNlLmRhdGEpOwogICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIm9uSnd0IiwgcmVzcG9uc2UuZGF0YSk7CiAgICAgIH0pLmNhdGNoKGVycm9yID0+IHsKICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJvbkVudGVyVmFsaWRhdGlvbkVycm9yIiwgZXJyb3IucmVzcG9uc2UuZGF0YSk7CiAgICAgIH0pOwogICAgfSk7CgogICAgdGhpcy4kcm9vdC4kb24oIm9uUmVnaXN0ZXIiLCAobG9naW4sIG5hbWUsIHBhc3N3b3JkKSA9PiB7CiAgICAgIGlmIChwYXNzd29yZCA9PT0gIiIpIHsKICAgICAgICB0aGlzLiRyb290LiRlbWl0KCJvblJlZ2lzdGVyVmFsaWRhdGlvbkVycm9yIiwgIlBhc3N3b3JkIGlzIHJlcXVpcmVkIik7CiAgICAgIH0KICAgICAgYXhpb3MucG9zdCgiL2FwaS8xL3VzZXJzL3JlZ2lzdGVyIiwge2xvZ2luLCBuYW1lLCBwYXNzd29yZH0pLnRoZW4oKCkgPT4gewogICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIm9uRW50ZXIiLCBsb2dpbiwgcGFzc3dvcmQpOwogICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIm9uQ2hhbmdlUGFnZSIsICJJbmRleCIpOwogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgdGhpcy4kcm9vdC4kZW1pdCgib25SZWdpc3RlclZhbGlkYXRpb25FcnJvciIsIGVycm9yLnJlc3BvbnNlLmRhdGEpOwogICAgICB9KTsKICAgIH0pOwoKICAgIHRoaXMuJHJvb3QuJG9uKCJvbkp3dCIsIChqd3QpID0+IHsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oImp3dCIsIGp3dCk7CgogICAgICBheGlvcy5nZXQoIi9hcGkvMS91c2Vycy9hdXRoIiwgewogICAgICAgIHBhcmFtczogewogICAgICAgICAgand0CiAgICAgICAgfQogICAgICB9KS50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICB0aGlzLnVzZXIgPSByZXNwb25zZS5kYXRhOwogICAgICAgIHRoaXMuJHJvb3QuJGVtaXQoIm9uQ2hhbmdlUGFnZSIsICJJbmRleCIpOwogICAgICB9KS5jYXRjaCgoKSA9PiB0aGlzLiRyb290LiRlbWl0KCJvbkxvZ291dCIpKQogICAgfSk7CgogICAgdGhpcy4kcm9vdC4kb24oIm9uTG9nb3V0IiwgKCkgPT4gewogICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgiand0Iik7CiAgICAgIHRoaXMudXNlciA9IG51bGw7CiAgICB9KTsKCiAgICAvLyB0aGlzLiRyb290LiRvbigib25Xcml0ZVBvc3QiLCAodGl0bGUsIHRleHQpID0+IHsKICAgIC8vICAgaWYgKHRleHQgPT09ICIiKSB7CiAgICAvLyAgICAgdGhpcy4kcm9vdC4kZW1pdCgib25Xcml0ZVBvc3RWYWxpZGF0aW9uRXJyb3IiLCAiVGV4dCBpcyByZXF1aXJlZCIpOwogICAgLy8gICAgIHJldHVybjsKICAgIC8vICAgfQogICAgLy8gICBjb25zdCBsb2dpbiA9IHRoaXMudXNlci5sb2dpbjsKICAgIC8vICAgYXhpb3MucG9zdCgiL2FwaS8xL3Bvc3RzIiwge3RpdGxlLCB0ZXh0LCBsb2dpbn0pLnRoZW4oKCkgPT4gewogICAgLy8gICAgIHRoaXMuJHJvb3QuJGVtaXQoIm9uQ2hhbmdlUGFnZSIsICkKICAgIC8vICAgfSkKICAgIC8vIH0pCiAgfQp9Cg=="},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;AASA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div id=\"app\">\n    <Header :user=\"user\"/>\n    <Middle :posts=\"posts\"/>\n    <Footer/>\n  </div>\n</template>\n\n<script>\nimport Header from \"./components/Header\";\nimport Middle from \"./components/Middle\";\nimport Footer from \"./components/Footer\";\nimport axios from \"axios\"\n\nexport default {\n  name: 'App',\n  components: {\n    Footer,\n    Middle,\n    Header\n  },\n  data: function() {\n    return {\n      user: null,\n      posts: []\n    }\n  },\n  beforeMount() {\n    if (localStorage.getItem(\"jwt\") && !this.user) {\n      this.$root.$emit(\"onJwt\", localStorage.getItem(\"jwt\"));\n    }\n\n    axios.get(\"/api/1/posts\").then(response => {\n      this.posts = response.data;\n    });\n  },\n  beforeCreate() {\n    this.$root.$on(\"onEnter\", (login, password) => {\n      if (password === \"\") {\n        this.$root.$emit(\"onEnterValidationError\", \"Password is required\");\n        return;\n      }\n\n      axios.post(\"/api/1/jwt\", {\n        login, password\n      }).then(response => {\n        localStorage.setItem(\"jwt\", response.data);\n        this.$root.$emit(\"onJwt\", response.data);\n      }).catch(error => {\n        this.$root.$emit(\"onEnterValidationError\", error.response.data);\n      });\n    });\n\n    this.$root.$on(\"onRegister\", (login, name, password) => {\n      if (password === \"\") {\n        this.$root.$emit(\"onRegisterValidationError\", \"Password is required\");\n      }\n      axios.post(\"/api/1/users/register\", {login, name, password}).then(() => {\n        this.$root.$emit(\"onEnter\", login, password);\n        this.$root.$emit(\"onChangePage\", \"Index\");\n      }).catch(error => {\n        this.$root.$emit(\"onRegisterValidationError\", error.response.data);\n      });\n    });\n\n    this.$root.$on(\"onJwt\", (jwt) => {\n      localStorage.setItem(\"jwt\", jwt);\n\n      axios.get(\"/api/1/users/auth\", {\n        params: {\n          jwt\n        }\n      }).then(response => {\n        this.user = response.data;\n        this.$root.$emit(\"onChangePage\", \"Index\");\n      }).catch(() => this.$root.$emit(\"onLogout\"))\n    });\n\n    this.$root.$on(\"onLogout\", () => {\n      localStorage.removeItem(\"jwt\");\n      this.user = null;\n    });\n\n    // this.$root.$on(\"onWritePost\", (title, text) => {\n    //   if (text === \"\") {\n    //     this.$root.$emit(\"onWritePostValidationError\", \"Text is required\");\n    //     return;\n    //   }\n    //   const login = this.user.login;\n    //   axios.post(\"/api/1/posts\", {title, text, login}).then(() => {\n    //     this.$root.$emit(\"onChangePage\", )\n    //   })\n    // })\n  }\n}\n</script>\n\n<style>\n#app {\n\n}\n</style>\n"]}]}